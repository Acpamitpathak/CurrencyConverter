import json
from fastapi import UploadFile

async def read_uploaded_json_file_as_string(file: UploadFile) -> str:
    """
    Reads an uploaded JSON file and returns it as a formatted string.
    """
    try:
        content = await file.read()
        decoded = content.decode('utf-8')
        data = json.loads(decoded)
        json_string = json.dumps(data, indent=4, ensure_ascii=False)
        return json_string
    except json.JSONDecodeError:
        return "Error: Invalid JSON format"
    except Exception as e:
        return f"Error reading file: {str(e)}"


@app.post("/upload-json/")
async def upload_json(file: UploadFile = File(...)):
    json_text = await read_uploaded_json_file_as_string(file)

    # You can return it or pass it to another function
    some_other_function(json_text)

    return {"raw_json_text": json_text}